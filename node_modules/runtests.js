function runTests(testFilenames, output, document) {
  // testFilenames a list of filenames, or to run all tests,
  // the path to a test directory.
  output.clearOutput(document);
  output.output("Running behave " + testFilenames.join(' '), document);
  var spawn = require("child_process").spawn;
  var clearNeeded = true;
  testRun = spawn('behave', testFilenames);
  testRun.stdout.on('data', function(data) {
    var str = String(data);
    var lines = str.split(/[\r\n]+/g);
    if (clearNeeded) {
      output.clearOutput(document);
      clearNeeded = false;
    }
    lines.forEach(function(line) {
      output.output(line, document);
  	});
  });
}

exports.runTests = runTests;
